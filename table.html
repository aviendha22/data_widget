<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>EVEREST Raw Data Table</title>
	<script>
	OWF.relayFile = '/owf-sample-html/js/eventing/rpc_relay.uncompressed.html';

    var logger = OWF.Log.getDefaultLogger();
    var appender = logger.getEffectiveAppenders()[0];

    // Enable logging 
    appender.setThreshold(log4javascript.Level.INFO);
    OWF.Log.setEnabled(false);


    function updateClock() {
        var currentTime = new Date ( );
        
        var currentHours = currentTime.getHours ( );
        var currentMinutes = currentTime.getMinutes ( );
        var currentSeconds = currentTime.getSeconds ( );
        
        // Pad the minutes and seconds with leading zeros, if required
        currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
        currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;
 
        // Choose either "AM" or "PM" as appropriate
        var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";
        
        // Convert the hours component to 12-hour format if needed
        currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;
        
        // Convert an hours component of "0" to "12"
        currentHours = ( currentHours == 0 ) ? 12 : currentHours;
        
        // Compose the string for display
        var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;
     
        // Update the time display
        document.getElementById("clock").firstChild.nodeValue = currentTimeString;
        OWF.Eventing.publish("ClockChannel", currentTimeString);
        
        // Log a message 
        if (currentSeconds % 10 == 0) {
        	logger.debug(currentTimeString);
        }

	}

    function initPage() { 
        updateClock();

        msg = 'Running in OWF: ' + (OWF.Util.isRunningInOWF()?"Yes":"No");

        document.getElementById("message-panel").innerHTML = msg;
        document.getElementById("message-panel").style.display = 'block';

        setInterval('updateClock()', 1000 )
    }

    owfdojo.addOnLoad(function() {
        OWF.ready(initPage);
    });
    </script>
</head>

<style>
#raw_data {
	border-color:#00f;
	border-width:3px;
	border-collapse:collapse;
}
td {
	padding:0px 15px 0px 5px;
}
.up{
	background-image:url('img/asc.png');
	background-repeat:no-repeat;
	background-position:right center;
}
.down{
	background-image:url('img/des.png');
	background-repeat:no-repeat;
	background-position:right center;
}
.unsorted{
	background-image:url('img/uns.png');
	background-repeat:no-repeat;
	background-position:right center;
}
th {
	cursor: pointer;
	padding:10px;
	text-align:left;
}
table {
	font-size:15px;
}
</style>
<body>

	<div id="owf"></div>
	<table border="1" id='raw_data'></table>

<script src="js/underscore.js"></script>
<script src="js/jquery.js"></script>
<script src="js/backbone.js"></script>
<script src="js/d3.v3.js"></script>
<script src="js/table.js"></script>
<script type="text/javascript" src="http://everest-build/owf-sample-html/js/owf-widget-debug.js"></script>
<script type="text/javascript" src="http://everest-build/owf-sample-html/js/owf-widget-min.js"></script>

<script>
	
	var logger, appender;
	if (window.owfdojo){
		var logger = OWF.Log.getDefaultLogger();
		var appender = logger.getEffectiveAppenders()[0];
		appender.setThreshold(log4javascript.Level.INFO);
		
		OWF.Log.setEnabled(true);
		
		owfdojo.ready(function() {
				OWF.ready(function(){
					OWF.notifyWidgetReady();
					
				});	
		}	);	
	}

    var msg = 'Running in OWF: ' + (OWF.Util.isRunningInOWF()?"Yes":"No");
	document.getElementById("owf").innerHTML = msg;
	document.getElementById("owf").style.display = 'block';
	
</script>


	
	<div class="widgetContents">
	<div class="panel-header">Announcing Clock</div>
	<div id="error-panel" class="error-panel"></div>
	<div class="panel-body">
		<div class="clock-frame">
			<span id="clock">&nbsp;</span>
		</div>
	</div>
		
	<div class="button-panel"></div>
		
	<div id="message-panel" class="message-panel"></div>
       
</body>
</html>